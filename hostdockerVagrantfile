Vagrant.configure("2") do |config|

    # Global provisioning command copy your ssh key into all vms
    config.vm.provision "file", source: "~/.ssh", destination: "/tmp"

    config.ssh.pty = true

    # Setup our docker host
    config.vm.box = "ubuntu/trusty64"
    config.vm.provision "docker"
    config.vm.hostname = "dr-01"
    config.vm.box_check_update = true
    config.vm.network "public_network", bridge: "eth0"
    config.vm.network "private_network", ip: "192.168.33.20"
    config.vm.synced_folder "~/Sites", "/sites"
    config.vm.post_up_message = "Welcome to Docker Host"
    config.vm.network "forwarded_port", guest: 8080, host: 7666

    # Configure VBox settings
    config.vm.provider :virtualbox do |vb|
        vb.name = "dockerhost"
        vb.gui = false
        vb.memory = 2576
        vb.cpus = 2
        vb.customize ["modifyvm", :id, "--cpuexecutioncap", "75"]
    end

    config.ssh.shell = "bash -c 'BASH_ENV=/etc/profile exec bash'"
 
    # Run some provisions on the vm
    config.vm.provision "shell", inline: <<-SHELL
        service sshd restart
        ps aux | grep 'sshd:' | awk '{print $2}' | xargs kill
        echo 'hello world' >> hi.txt
        cp -Rf /tmp/.ssh/ /root/
    SHELL

end
